pathRes
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
pth
pathRes
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
pathRes
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
thisCol = c(1,0,1,1,0)
which(thisCol)
which(thisCol==1)
rm(list = ls(all=TRUE))
source("MultiLevelPathAnalysis2.R")
pathRes
pth
pathRes
pth = pathRes
pth$nBootReps = 10
for( i in 1:length(pth$nBootReps) {
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
#path_df 	<- as.data.frame(rbind(path_df, indirectPathCoefs(boot_pth)))
}
}
for( i in 1:length(pth$nBootReps) {
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
#path_df 	<- as.data.frame(rbind(path_df, indirectPathCoefs(boot_pth)))
}
for(i in 1:length(pth$nBootReps)){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
#path_df 	<- as.data.frame(rbind(path_df, indirectPathCoefs(boot_pth)))
}
boot_pth
indirectPathCoefs(boot_pth)
boot_pth$indirectPathCoefs)
boot_pth$indirectPathCoefs
as.vector(boot_pth$indirectPathCoefs)
boot_pth$indirectPathCoefs[[1]]
boot_pth$indirectPathCoefs[[:]]
boot_pth$indirectPathCoefs[[]]
boot_pth$indirectPathCoefs[[,]]
boot_pth$indirectPathCoefs[[,,]]
boot_pth$indirectPathCoefs[[1:2]]
boot_pth$indirectPathCoefs[[1]]
boot_pth$indirectPathCoefs[[c(1,2)]]
boot_pth$indirectPathCoefs[[2]]
boot_pth$indirectPathCoefs[[1:2]]
boot_pth$indirectPathCoefs[1:2]
boot_pth$indirectPathCoefs
a<-boot_pth$indirectPathCoefs
unlist(a)
path_df
path_df     <- as.data.frame(rbind(path_df, unlist(boot_pth$indirectPathCoefs)))
path_df
path_df = NULL
path_df
rbind(path_df, unlist(boot_pth$indirectPathCoefs))
path_df = NULL
for(i in 1:length(pth$nBootReps)){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = indirectPathCoefs(boot_pth)
path_df 	<- as.data.frame(rbind(path_df, unlist(boot_pth$indirectPathCoefs)))
}
pth$boot$dist = path_df
path_df
i
path_df = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = indirectPathCoefs(boot_pth)
path_df 	<- as.data.frame(rbind(path_df, unlist(boot_pth$indirectPathCoefs)))
}
pth$boot$dist = path_df
path_df
pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
path_df 	<- as.data.frame(rbind(path_df, unlist(boot_pth$indirectPathCoefs)))
}
path_df
sort(path_df)
sort(path_df[1,])
sort(path_df[,1])
sort(path_df[,])
sort(path_df[])
sort(path_df[:])
help(order)
order(path_df)
help(with)
dd[with(d, order(V1, V2)), ]
d[with(d, order(V1, V2)), ]
path_df[with(path_df, order(V1, V2)), ]
path_df[with(path_df, order(V2)), ]
order(V1, V2)
order(path_df$V1, path_df$V2)
order(path_df$V1)
path_df$V1[order(path_df$V1)]
path_df[with(path_df, order(V1, V2)), ]
path_df
order(path_df)
path_df[order(path_df)]
path_df[order(path_df),]
help(tapply)
path_df
tapply(1:2, path_df, sort)
sapply(path_df, function(x) max(x))
sapply(path_df, function(x) sort(x))
sapply(path_df, sort)
.5*ncols(path_df)
.5*ncol(path_df)
.05*nrow(path_df)
round(.05*nrow(path_df))
c(round(.025*nrow(path_df)), round(.975*nrow(path_df)))
idxCI = c(round(.025*nrow(path_df)), round(.975*nrow(path_df)))
idxCI
idxCI = c(ceil(.025*nrow(path_df)), round(.975*nrow(path_df)))
idxCI = c(ceiling(.025*nrow(path_df)), ceiling(.975*nrow(path_df)))
idxCI
path_df[idxCI]
path_df[idxCI,]
a<-path_df[idxCI]
a<-path_df[idxCI,]
a
a[1,]
a2<-a[1,]
path_df
path_df > a
as.matrix(path_df) > as.matrix(a)
as.matrix(path_df)
m<-as.matrix(path_df)
m
a2
a3<-as.matrix(a2)
a3
m
sapply(m, function(x) x>a3)
v<-sapply(m, function(x) x>a3)
v
t(v)
pth$indirectPathCoefs
unlist(pth$indirectPathCoefs)
v<-sapply(as.matrix(path_df), function(x) x>unlist(pth$indirectPathCoefs))
v
v
which(v)
sapply(v, function(x) length(which(x))
)
sapply(v, function(x) length(which(x)))
sapply(t(v), function(x) length(which(x)))
as.numeric(TRUE)
v<-sapply(as.matrix(path_df), function(x) as.numeric(x>unlist(pth$indirectPathCoefs)))
v
sum(v)
rowsum(v)
help(rowsum)
rowsum(v, 1:10)
rowsum(v, 1:2)
colsum(v, 1:2)
rowsum(v, 1:2)
rowSums(v, 1:2)
rowSums(v)
ncol(v)
rowSums(v)/ncol(v)
.5 - rowSums(v)/ncol(v)
abs(.5 - rowSums(v)/ncol(v))
2*abs(.5 - rowSums(v)/ncol(v))
p_h = 2*abs(.5 - rowSums(v)/ncol(v))
p_h
sapply(p_h, function(x) max(c(x, 1-x)))
doc(matrix)
help(matrix)
pth$coefMatrix
dim(pth$coefMatrix)
boot_pth
boot_pth$coefMatrix
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_pats(,,i)<-boot_pth$coefMatrix
}
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_paths[,,i]<-boot_pth$coefMatrix
}
dir_paths
sapply(dir_paths, sort)
pth$nVars
pth$coefMatrix
pth
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_paths[,,i]<-boot_pth$coefMatrix
}
dir_paths
pth$bootDirect$dist = dir_paths
pth$bootDirect$CI95Pct = array(NULL, dim(pth$coefMatrix))
pth$bootDirect$p = array(NULL, dim(pth$coefMatrix))
array(c(-1, -1), dim(pth$coefMatrix))
a<-array(c(-1, -1), dim(pth$coefMatrix))
a
a[1,1]
a<-array( -1, dim(pth$coefMatrix))
a
a<-array(list(NULL), dim(pth$coefMatrix))
a
a<-array(list(-1,-1), dim(pth$coefMatrix))
a
a[1]
a[1][1]
a[1]
v = a[1]
v
v[1]
v[[1]]
v[[2]]
v[1]
v[2]
v[3]
pth$bootDirect$CI95Pct = array(list(NULL), dim(pth$coefMatrix))
pth$bootDirect$p = array(-1, dim(pth$coefMatrix))
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[i,j,] = c(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dir$dist_prop<- as.numeric(pth$coefMatrix>thisSortedVec)
dir$p_h = 2*abs(.5 - sum(dir$dist_prop)/ncol(dir$dist_prop))
pth$bootDirect$p = sapply(dir$p_h, function(x) min(c(x, 1-x)))
}
}
i
j
dir_paths[i,j,]
thisSortedVec = sort(dir_paths[i,j,])
c(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
idxCE
idxCI
idxCI[1]
idxCI[2]
thisSortedVec
ind_paths
idxCI
nrow(ind_paths)
idxCI = c(round(.025*nrow(ind_paths)+.5), round(.975*nrow(ind_paths)+.5))
idxCI
c(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
pth$bootDirect$CI95Pct[i,j,] = c(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
pth$bootDirect$CI95Pct
pth$bootDirect$CI95Pct[1,1,]
pth$bootDirect$CI95Pct[1,1]
pth$bootDirect$CI95Pct[i,j] = c(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
pth$bootDirect$CI95Pct[i,j] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
pth$bootDirect$CI95Pct
pth$bootDirect$CI95Pct = array(list('a','b','c'), dim(pth$coefMatrix))
pth$bootDirect$CI95Pct
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
pth$bootDirect$CI95Pct
pth$bootDirect$CI95Pct[[i,j]]
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dir$dist_prop<- as.numeric(pth$coefMatrix>thisSortedVec)
dir$p_h = 2*abs(.5 - sum(dir$dist_prop)/ncol(dir$dist_prop))
pth$bootDirect$p = sapply(dir$p_h, function(x) min(c(x, 1-x)))
}
}
pth$coefMatrix>thisSortedVec
thisSortedVec
pth$coefMatrix[i,j]>thisSortedVec
as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
dir$dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
2*abs(.5 - sum(dist_prop)/ncol(dir$dist_prop))
2*abs(.5 - sum(dist_prop)/ncol(dist_prop))
sum(dist_prop)
ncol(dist_prop)
2*abs(.5 - sum(dist_prop)/length(dir$dist_prop))
2*abs(.5 - sum(dist_prop)/length(dist_prop))
dir$p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
dir
p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
p_h
sapply(p_h, function(x) min(c(x, 1-x)))
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
pth$bootDirect$p[i,j] = sapply(p_h, function(x) min(c(x, 1-x)))
}
}
pth$bootDirect
pth$bootDirect$CI95Pct
pth$bootDirect$CI95Pct[3,4]
pth$bootDirect$CI95Pct[4,3]
pth$bootDirect$CI95Pct[4,2]
pth$bootDirect$CI95Pct[4,1]
pth$bootDirect$CI95Pct[4,2]
bootStrapCoefs <- function(pth){
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_paths[,,i]<-boot_pth$coefMatrix
}
ind$sorted_dists = sapply(ind_paths, sort)
idxCI = c(round(.025*nrow(ind_paths)+.5), round(.975*nrow(ind_paths)+.5))
ind$dist_prop<-sapply(as.matrix(ind_paths), function(x) as.numeric(x>unlist(pth$indirectPathCoefs)))
ind$p_h = 2*abs(.5 - rowSums(ind$dist_prop)/ncol(ind$dist_prop))
ind$p = sapply(ind$p_h, function(x) min(c(x, 1-x)))
pth$bootDirect$dist = dir_paths
pth$bootDirect$CI95Pct = array(list(NULL), dim(pth$coefMatrix))
pth$bootDirect$p = array(-1, dim(pth$coefMatrix))
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
p = sapply(p_h, function(x) min(c(x, 1-x)))
if (p==0) {
p = 1/pth$nBootReps
}
pth$bootDirect$p[i,j] = p
}
}
pth$bootIndirect$dist = ind_paths
pth$bootIndirect$CI95pct = ind$sorted_dists[idxCI,]
pth$bootIndirect$p = p
}
bootStrapCoefs(pth)
bootStrapCoefs <- function(pth){
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_paths[,,i]<-boot_pth$coefMatrix
}
idxCI = c(round(.025*nrow(ind_paths)+.5), round(.975*nrow(ind_paths)+.5))
ind = list()
ind$sorted_dists = sapply(ind_paths, sort)
ind$dist_prop<-sapply(as.matrix(ind_paths), function(x) as.numeric(x>unlist(pth$indirectPathCoefs)))
ind$p_h = 2*abs(.5 - rowSums(ind$dist_prop)/ncol(ind$dist_prop))
ind$p = sapply(ind$p_h, function(x) min(c(x, 1-x)))
pth$bootDirect$dist = dir_paths
pth$bootDirect$CI95Pct = array(list(NULL), dim(pth$coefMatrix))
pth$bootDirect$p = array(-1, dim(pth$coefMatrix))
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
p = sapply(p_h, function(x) min(c(x, 1-x)))
if (p==0) {
p = 1/pth$nBootReps
}
pth$bootDirect$p[i,j] = p
}
}
pth$bootIndirect$dist = ind_paths
pth$bootIndirect$CI95pct = ind$sorted_dists[idxCI,]
pth$bootIndirect$p = p
}
bootStrapCoefs(pth)
pth2<-bootStrapCoefs(pth)
pth2
bootStrapCoefs <- function(pth){
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_paths[,,i]<-boot_pth$coefMatrix
}
idxCI = c(round(.025*nrow(ind_paths)+.5), round(.975*nrow(ind_paths)+.5))
ind = list()
ind$sorted_dists = sapply(ind_paths, sort)
ind$dist_prop<-sapply(as.matrix(ind_paths), function(x) as.numeric(x>unlist(pth$indirectPathCoefs)))
ind$p_h = 2*abs(.5 - rowSums(ind$dist_prop)/ncol(ind$dist_prop))
ind$p = sapply(ind$p_h, function(x) min(c(x, 1-x)))
pth$bootDirect$dist = dir_paths
pth$bootDirect$CI95Pct = array(list(NULL), dim(pth$coefMatrix))
pth$bootDirect$p = array(-1, dim(pth$coefMatrix))
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
p = sapply(p_h, function(x) min(c(x, 1-x)))
if (p==0) {
p = 1/pth$nBootReps
}
pth$bootDirect$p[i,j] = p
}
}
pth$bootIndirect$dist = ind_paths
pth$bootIndirect$CI95pct = ind$sorted_dists[idxCI,]
pth$bootIndirect$p = p
return(pth)
}
pth2<-bootStrapCoefs(pth)
pth2
pth2$bootDirect
pth2$bootDirect$CI95Pct
pth2$bootDirect$CI95Pct[1,1]
pth2$bootDirect$CI95Pct[4,2]
pth$indirectPaths
pth$indirectPathCoefs
pth$bootIndirect
pth2
bootStrapCoefs <- function(pth){
dir_paths = array(0, c(dim(pth$coefMatrix), pth$nBootReps))
ind_paths = NULL
for(i in 1:pth$nBootReps){
boot_DF     <- pth$DF[sample( 1:nrow(pth$DF), replace=TRUE),]
boot_pth = pth
boot_pth$DF = boot_DF
boot_pth = directPathCoeffs(boot_pth)
boot_pth = indirectPathCoefs(boot_pth)
ind_paths 	<- as.data.frame(rbind(ind_paths, unlist(boot_pth$indirectPathCoefs)))
dir_paths[,,i]<-boot_pth$coefMatrix
}
idxCI = c(round(.025*nrow(ind_paths)+.5), round(.975*nrow(ind_paths)+.5))
pth$bootDirect$dist = dir_paths
pth$bootDirect$CI95Pct = array(list(NULL), dim(pth$coefMatrix))
pth$bootDirect$p = array(-1, dim(pth$coefMatrix))
for(i in 1:pth$nVars){
for(j in 1:pth$nVars){
thisSortedVec = sort(dir_paths[i,j,])
pth$bootDirect$CI95Pct[[i,j]] = list(thisSortedVec[idxCI[1]],thisSortedVec[idxCI[2]])
dist_prop<- as.numeric(pth$coefMatrix[i,j]>thisSortedVec)
p_h = 2*abs(.5 - sum(dist_prop)/length(dist_prop))
p = sapply(p_h, function(x) min(c(x, 1-x)))
if (p==0) {
p = 1/pth$nBootReps
}
pth$bootDirect$p[i,j] = p
}
}
ind = list()
ind$sorted_dists = sapply(ind_paths, sort)
ind$dist_prop<-sapply(as.matrix(ind_paths), function(x) as.numeric(x>unlist(pth$indirectPathCoefs)))
ind$p_h = 2*abs(.5 - rowSums(ind$dist_prop)/ncol(ind$dist_prop))
ind$p = sapply(ind$p_h, function(x) min(c(x, 1-x)))
pth$bootIndirect$dist = ind_paths
pth$bootIndirect$CI95pct = ind$sorted_dists[idxCI,]
pth$bootIndirect$p = ind$p
return(pth)
}
pth3<-bootStrapCoefs(pth)
pth3
